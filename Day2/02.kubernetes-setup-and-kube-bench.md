
# ☸️ Kubernetes Installation & Kube-Bench Security Scan

This guide walks through installing Kubernetes using CRI-O, initializing a cluster, setting up Calico networking, and running CIS benchmark scans with Kube-Bench.

---

## 🧱 Step 1: Install Kubernetes Components

Get the Kubernetes installation script:

```bash
# Download the script from the repo
https://github.com/networknuts/kubernetes/blob/master/scripts/packages-kubernetes-1.32
````

Copy the contents into a local script:

```bash
vim packages.sh  # Paste the contents from the GitHub script
sudo sh packages.sh
```

---

## 🛠️ Step 2: Pull Kubernetes Images

```bash
sudo kubeadm config images pull --cri-socket unix:///var/run/crio/crio.sock
```

---

## 🚀 Step 3: Initialize the Cluster

```bash
sudo kubeadm init \
  --apiserver-advertise-address=10.0.0.100 \
  --pod-network-cidr=172.17.0.0/16 \
  --cri-socket=unix:///var/run/crio/crio.sock
```

> ✅ **Note:** After the `kubeadm init` command completes, it will display **3 post-setup commands** to run in order to start using your cluster. Run those immediately.
> *(These commands set up `kubectl` config and permissions for your user.)*

📷 *Example Output:*

![kubeadm init result](https://github.com/user-attachments/assets/4abd842a-558e-4bf6-8e00-e85ef3378b25)

---

## 🌐 Step 4: Install Calico Network Plugin

Download the Calico manifest:

```bash
# Get the script from:
https://github.com/networknuts/kubernetes/blob/master/scripts/calico.yaml
```

Apply the manifest:

```bash
vim calico.yaml  # Paste contents from the URL above
kubectl apply -f calico.yaml
```

Verify system pod status:

```bash
kubectl -n kube-system get pods
```

---

## 🔐 Step 5: Install Kube-Bench for CIS Security Scanning

Kube-Bench runs the CIS Kubernetes Benchmark and reports security configuration issues.

### 📥 Download and Install

```bash
# Download the .deb package for kube-bench
curl -L https://bit.ly/32BQF8G -o kube-bench_0.3.1_linux_amd64.deb

# View and install
ll
sudo -i
sudo dpkg -i kube-bench_0.3.1_linux_amd64.deb
```

### 🚀 Run Kube-Bench Scan

```bash
kube-bench master
```

> This will output a report based on the CIS Kubernetes Benchmark. It shows passed, failed, and skipped checks categorized by control groups.

---

## 🛠️ Step 6: Fixing Vulnerabilities

You should now go through the failed items reported by `kube-bench` and fix them according to CIS recommendations.

**ℹ️ Fix instructions will be added here later.**

---

## ✅ Summary

| Step | Task                                      |
| ---- | ----------------------------------------- |
| 1    | Installed Kubernetes packages using CRI-O |
| 2    | Pulled images and initialized cluster     |
| 3    | Installed Calico for networking           |
| 4    | Verified system pod status                |
| 5    | Installed and ran `kube-bench`            |
| 6    | Security hardening (in progress)          |

Stay secure, and keep iterating your cluster’s security posture! 🔒



Let me know when you're ready to add the **vulnerability fix** section or automate these steps in a script or CI pipeline.
```
